<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>+Milion√°ria | Dashboard Inteligente</title>

  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"></noscript>

  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    tailwind.config = {
      important: false,
      corePlugins: {
        preflight: false,
      },
      theme: {
        extend: {
          colors: {
            'primary': '#00E38C',
            'secondary': '#8B5CF6',
            'background': '#000000', // Certifique-se que esta √© a cor de fundo desejada
            'card': '#1A1D25',
            'surface': '#2E303A',
          }
        }
      }
    }
  </script>

  <link rel="stylesheet" href="{{ url_for('static', filename='css/estilo.css') }}">

  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

</head>
<body class="p-4 sm:p-6">
  <!-- Header -->
  <header class="flex justify-between items-center mb-8">
    <div>
      <h1 class="text-2xl sm:text-3xl font-bold text-white">+Milion√°ria</h1>
      <p class="text-sm sm:text-base text-gray-400">Dashboard Inteligente de An√°lise Estat√≠stica</p>
    </div>
    
    <!-- Logo centralizada -->
    <div class="flex justify-center items-center">
      <img src="/static/img/Logo_LoteriasIntelitente.png" alt="Logo Loterias Inteligente" class="max-w-[120px] sm:max-w-[150px] md:max-w-[180px]">
    </div>
    
    <button class="bg-[#8B5CF6] px-4 py-2 rounded-xl font-semibold hover:opacity-80 transition-all text-sm sm:text-base">
      Login / Criar Conta
    </button>
  </header>

  <!-- Cart√£o de jogo -->
  <section class="bg-[#1A1D25] p-6 rounded-2xl shadow-md mb-8 flex flex-col">
    <h2 class="text-xl font-semibold mb-4">üéØ Selecione 6 n√∫meros entre 50</h2>
    <div class="grid grid-cols-10 gap-2 mb-6" id="numeros-container">
      <!-- N√∫meros ser√£o gerados dinamicamente -->
    </div>

    <!-- Dois conjuntos de trevos na mesma linha -->
    <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-8">
      <!-- Conjunto 1: Trevo 1 -->
      <div>
        <h3 class="text-lg mb-2"><img src="/static/img/trevo4folhas.webp" alt="Trevo" class="inline w-4 h-4 mr-1"> Escolha Trevo 1</h3>
        <div class="flex gap-4 flex-wrap" id="trevo1-container">
          <!-- Trevo 1 ser√° gerado dinamicamente -->
        </div>
      </div>

      <!-- Conjunto 2: Trevo 2 -->
      <div>
        <h3 class="text-lg mb-2"><img src="/static/img/trevo4folhas.webp" alt="Trevo" class="inline w-4 h-4 mr-1"> Escolha Trevo 2</h3>
        <div class="flex gap-4 flex-wrap" id="trevo2-container">
          <!-- Trevo 2 ser√° gerado dinamicamente -->
        </div>
      </div>
    </div>

    <!-- N√∫meros selecionados -->
    <div class="mt-6 p-4 bg-[#2E303A] rounded-xl">
      <div class="grid grid-cols-3 gap-6">
        <!-- Coluna 1: N√∫meros principais -->
        <div>
          <h4 class="text-sm font-semibold mb-2">N√∫meros Selecionados:</h4>
          <div class="flex gap-2 flex-wrap" id="numeros-selecionados">
            <span class="text-gray-400">Nenhum n√∫mero selecionado</span>
          </div>
        </div>
        
        <!-- Coluna 2: Trevos -->
        <div>
          <h4 class="text-sm font-semibold mb-2">Trevo 1:</h4>
          <div class="flex gap-2 flex-wrap" id="trevo1-selecionado">
            <span class="text-gray-400">Nenhum trevo selecionado</span>
          </div>
          <h4 class="text-sm font-semibold mb-2 mt-4">Trevo 2:</h4>
          <div class="flex gap-2 flex-wrap" id="trevo2-selecionado">
            <span class="text-gray-400">Nenhum trevo selecionado</span>
          </div>
        </div>
        
        <!-- Coluna 3: Valor da aposta -->
        <div class="flex flex-col justify-center items-center">
          <div id="valor-aposta-container" class="text-center">
            <div class="text-gray-400 text-sm">Aposta n√£o configurada</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Container espec√≠fico para o Gerador de N√∫meros +Milion√°ria -->
    <div class="gerador-container mt-6 p-6 bg-[#1A1D25] rounded-xl shadow-md">
      <h3 class="text-lg font-semibold mb-4 text-center">üéØ Gerador de N√∫meros +Milion√°ria</h3>
                      <p class="text-gray-400 text-center mb-4 text-sm">Op√ß√µes para gerar seus palpites</p>
      
      <div class="botoes-mobile-ajustados">
        <button class="bg-[#00E38C] text-black font-bold px-6 py-3 rounded-xl hover:opacity-80 transition-all text-sm" onclick="abrirModalConfiguracao()">
          üé≤ Gerar Aleat√≥rio<br><small class="texto-gratuito">GRATUITO</small>
        </button>
      
        <button class="bg-gray-600 text-gray-400 font-bold px-6 py-3 rounded-xl cursor-not-allowed text-sm" disabled>
          üìä An√°lise Estat√≠stica<br><small class="texto-premium">PREMIUM</small>
        </button>
      
        <button class="bg-red-600 text-white font-bold px-6 py-3 rounded-xl hover:opacity-80 transition-all text-sm" onclick="limparSelecao()">
          üóëÔ∏è Limpar Tudo
        </button>
      </div>
      
      <div class="mt-4 text-center">
        <p class="text-xs text-gray-500">
                                  üí° Experimente o gerador aleat√≥rio gratuitamente!
        </p>
      </div>
    </div>

    <!-- Bot√µes de an√°lise -->
    <div class="mt-8 flex flex-wrap gap-4">
      <button class="bg-[#00E38C] text-black font-semibold px-4 py-2 rounded-xl hover:opacity-80 transition-all text-sm sm:text-base" onclick="abrirModal('frequencia')">
        üìä Frequ√™ncia
      </button>
      <button class="bg-[#00E38C] text-black font-semibold px-4 py-2 rounded-xl hover:opacity-80 transition-all text-sm sm:text-base" onclick="abrirModal('distribuicao')">
        üî¢ Distribui√ß√£o
      </button>
      <button class="bg-[#00E38C] text-black font-semibold px-4 py-2 rounded-xl hover:opacity-80 transition-all text-sm sm:text-base" onclick="abrirModal('afinidades')">
        ü§ù Afinidades
      </button>
      <button class="bg-[#00E38C] text-black font-semibold px-4 py-2 rounded-xl hover:opacity-80 transition-all text-sm sm:text-base" onclick="abrirModal('trevos')">
        <img src="/static/img/trevo4folhas.webp" alt="Trevo" class="inline w-4 h-4 mr-1"> Trevos
      </button>
      <button class="bg-[#00E38C] text-black font-semibold px-4 py-2 rounded-xl hover:opacity-80 transition-all text-sm sm:text-base" onclick="abrirModal('seca')">
        üåµ Seca
      </button>
      <button class="bg-[#00E38C] text-black font-semibold px-4 py-2 rounded-xl hover:opacity-80 transition-all text-sm sm:text-base" onclick="abrirModal('estatisticas')">
        üìà Estat√≠sticas Avan√ßadas
      </button>
    </div>
  </section>

  <!-- Se√ß√£o de Estat√≠sticas R√°pidas -->
  <section class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    <div class="stat-card p-6 rounded-2xl">
      <h3 class="text-lg font-semibold mb-2">üî• N√∫meros Quentes</h3>
      <div class="text-sm text-gray-300" id="numeros-quentes">
        Carregando...
      </div>
    </div>
    <div class="stat-card p-6 rounded-2xl">
      <h3 class="text-lg font-semibold mb-2">‚ùÑÔ∏è N√∫meros Frios</h3>
      <div class="text-sm text-gray-300" id="numeros-frios">
        Carregando...
      </div>
    </div>
    <div class="stat-card p-6 rounded-2xl">
      <h3 class="text-lg font-semibold mb-2"><img src="/static/img/trevo4folhas.webp" alt="Trevo" class="inline w-4 h-4 mr-1"> Trevos Mais Frequentes</h3>
      <div class="text-sm text-gray-300" id="trevos-frequentes">
        Carregando...
      </div>
    </div>
  </section>



  <!-- Modal base -->
  <div id="modal" class="hidden fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50">
    <div class="bg-[#1A1D25] p-8 rounded-2xl w-full max-w-6xl relative modal-content">
      <button class="absolute top-3 right-4 text-white text-xl font-bold hover:text-gray-300 transition-all" onclick="fecharModal()">√ó</button>
      <h2 id="titulo-modal" class="text-2xl font-semibold mb-4">T√≠tulo do Modal</h2>
      <div id="conteudo-modal" class="text-gray-300">
        Carregando an√°lise...
      </div>
    </div>
  </div>

  <!-- Modal de Configura√ß√£o de Aposta -->
  <div id="modalConfiguracao" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
    <div class="bg-[#1A1D25] p-8 rounded-2xl shadow-xl w-96 text-white">
      <h3 class="text-xl font-bold mb-6 text-center text-[#00E38C]">üé≤ Configurar Aposta Aleat√≥ria</h3>

      <div class="mb-5">
        <label for="sliderNumeros" class="block text-gray-300 text-sm font-semibold mb-2">Quantos n√∫meros principais? (6-12)</label>
        <input type="range" id="sliderNumeros" min="6" max="12" value="8" class="w-full h-2 bg-[#2E303A] rounded-lg appearance-none cursor-pointer range-lg">
        <span id="valorNumeros" class="block text-center text-lg font-bold mt-2 text-[#00E38C]">8</span>
      </div>

      <div class="mb-5">
        <label for="sliderTrevo1" class="block text-gray-300 text-sm font-semibold mb-2">üçÄ Quantos n√∫meros para Trevo 1? (1-3)</label>
        <input type="range" id="sliderTrevo1" min="1" max="3" value="1" class="w-full h-2 bg-[#2E303A] rounded-lg appearance-none cursor-pointer range-lg">
        <span id="valorTrevo1" class="block text-center text-lg font-bold mt-2 text-[#8B5CF6]">1</span>
      </div>

      <div class="mb-8">
        <label for="sliderTrevo2" class="block text-gray-300 text-sm font-semibold mb-2">üçÄ Quantos n√∫meros para Trevo 2? (1-3)</label>
        <input type="range" id="sliderTrevo2" min="1" max="3" value="1" class="w-full h-2 bg-[#2E303A] rounded-lg appearance-none cursor-pointer range-lg">
        <span id="valorTrevo2" class="block text-center text-lg font-bold mt-2 text-[#8B5CF6]">1</span>
      </div>

      <div class="flex justify-end space-x-4">
        <button id="btnCancelarModal" class="bg-gray-600 text-white px-4 py-2 rounded-xl font-semibold hover:opacity-80 transition-all">Cancelar</button>
        <button id="btnGerarNoModal" class="bg-[#00E38C] text-black px-4 py-2 rounded-xl font-semibold hover:opacity-80 transition-all">Gerar Aposta</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script>
    // Dados simulados (ser√£o substitu√≠dos pelos dados reais)
    const dadosMilionaria = {
      frequencia: {
        numeros: {
          quentes: [21, 41, 50, 23, 44, 16, 35, 42, 47, 48],
          frios: [49, 43, 45, 46, 40, 39, 38, 37, 36, 34]
        },
        trevos: {
          frequentes: [2, 4, 1, 6, 3, 5]
        }
      },
      distribuicao: {
        pares: 3.04,
        impares: 2.96,
        faixas: {
          "1-10": 0.8,
          "11-20": 1.2,
          "21-30": 1.1,
          "31-40": 1.3,
          "41-50": 1.6
        }
      },
      afinidades: {
        positivas: [
          { num1: 21, num2: 22, correlacao: 0.182 },
          { num1: 17, num2: 46, correlacao: 0.173 },
          { num1: 4, num2: 38, correlacao: 0.155 }
        ],
        negativas: [
          { num1: 24, num2: 25, correlacao: -0.159 },
          { num1: 20, num2: 41, correlacao: -0.155 }
        ]
      },
      seca: {
        maior: [49, 43, 45, 46, 40],
        recentes: [21, 41, 50, 23, 44]
      }
    };

    // Vari√°veis globais
    let numerosSelecionados = [];
    let trevo1Selecionados = [];
    let trevo2Selecionados = [];

    // Inicializa√ß√£o - Aguarda carregamento completo dos estilos
    function inicializarAplicacao() {
      gerarNumeros();
      gerarTrevo1();
      gerarTrevo2();
      carregarEstatisticasRapidas();
    }

    // Aguarda tanto DOM quanto estilos carregados
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', inicializarAplicacao);
    } else {
      // DOM j√° carregado, aguarda estilos
      window.addEventListener('load', inicializarAplicacao);
    }

    // Gerar n√∫meros de 1 a 50
    function gerarNumeros() {
      const container = document.getElementById('numeros-container');
      container.innerHTML = '';
      
      for (let i = 1; i <= 50; i++) {
        const div = document.createElement('div');
        div.className = 'numero p-3 rounded-xl text-center font-semibold';
        div.textContent = i.toString().padStart(2, '0');
        div.onclick = () => selecionarNumero(i, div);
        container.appendChild(div);
      }
    }

    // Gerar trevo 1
    function gerarTrevo1() {
      const container = document.getElementById('trevo1-container');
      container.innerHTML = '';
      
      for (let i = 1; i <= 6; i++) {
        const div = document.createElement('div');
        div.className = 'trevo px-4 py-2 rounded-xl font-semibold';
        div.textContent = i;
        div.onclick = () => selecionarTrevo1(i, div);
        container.appendChild(div);
      }
    }

    // Gerar trevo 2
    function gerarTrevo2() {
      const container = document.getElementById('trevo2-container');
      container.innerHTML = '';
      
      for (let i = 1; i <= 6; i++) {
        const div = document.createElement('div');
        div.className = 'trevo px-4 py-2 rounded-xl font-semibold';
        div.textContent = i;
        div.onclick = () => selecionarTrevo2(i, div);
        container.appendChild(div);
      }
    }

    // Selecionar n√∫mero (manual - limite de 6)
    function selecionarNumero(numero, elemento) {
      if (numerosSelecionados.includes(numero)) {
        numerosSelecionados = numerosSelecionados.filter(n => n !== numero);
        elemento.classList.remove('selecionado');
      } else if (numerosSelecionados.length < 6) {
        numerosSelecionados.push(numero);
        elemento.classList.add('selecionado');
      } else {
        alert('Voc√™ j√° selecionou 6 n√∫meros!');
        return;
      }
      atualizarNumerosSelecionados();
    }

    // Selecionar n√∫mero automaticamente (sem limite)
    function selecionarNumeroAutomatico(numero, elemento) {
      if (!numerosSelecionados.includes(numero)) {
        numerosSelecionados.push(numero);
        elemento.classList.add('selecionado');
      }
      atualizarNumerosSelecionados();
    }

    // Selecionar trevo 1
    function selecionarTrevo1(trevo, elemento) {
      if (trevo1Selecionados.includes(trevo)) {
        trevo1Selecionados = trevo1Selecionados.filter(t => t !== trevo);
        elemento.classList.remove('selecionado');
      } else if (trevo1Selecionados.length < 3) {
        trevo1Selecionados.push(trevo);
        elemento.classList.add('selecionado');
      } else {
        alert('Voc√™ j√° selecionou 3 n√∫meros para Trevo 1!');
        return;
      }
      atualizarTrevo1Selecionado();
    }

    // Selecionar trevo 2
    function selecionarTrevo2(trevo, elemento) {
      if (trevo2Selecionados.includes(trevo)) {
        trevo2Selecionados = trevo2Selecionados.filter(t => t !== trevo);
        elemento.classList.remove('selecionado');
      } else if (trevo2Selecionados.length < 3) {
        trevo2Selecionados.push(trevo);
        elemento.classList.add('selecionado');
      } else {
        alert('Voc√™ j√° selecionou 3 n√∫meros para Trevo 2!');
        return;
      }
      atualizarTrevo2Selecionado();
    }

    // Atualizar display dos n√∫meros selecionados
    function atualizarNumerosSelecionados() {
      const container = document.getElementById('numeros-selecionados');
      if (numerosSelecionados.length === 0) {
        container.innerHTML = '<span class="text-gray-400">Nenhum n√∫mero selecionado</span>';
      } else {
        container.innerHTML = numerosSelecionados
          .sort((a, b) => a - b)
          .map(n => `<span class="bg-[#00E38C] text-black px-2 py-1 rounded font-semibold">${n.toString().padStart(2, '0')}</span>`)
          .join('');
      }
    }

    // Atualizar display do trevo 1 selecionado
    function atualizarTrevo1Selecionado() {
      const container = document.getElementById('trevo1-selecionado');
      if (trevo1Selecionados.length === 0) {
        container.innerHTML = '<span class="text-gray-400">Nenhum trevo selecionado</span>';
      } else {
        container.innerHTML = trevo1Selecionados
          .sort((a, b) => a - b)
          .map(t => `<span class="bg-[#8B5CF6] text-white px-2 py-1 rounded font-semibold">${t}</span>`)
          .join('');
      }
    }

    // Atualizar display do trevo 2 selecionado
    function atualizarTrevo2Selecionado() {
      const container = document.getElementById('trevo2-selecionado');
      if (trevo2Selecionados.length === 0) {
        container.innerHTML = '<span class="text-gray-400">Nenhum trevo selecionado</span>';
      } else {
        container.innerHTML = trevo2Selecionados
          .sort((a, b) => a - b)
          .map(t => `<span class="bg-[#8B5CF6] text-white px-2 py-1 rounded font-semibold">${t}</span>`)
          .join('');
      }
    }

    // Atualizar display do valor da aposta
    function atualizarValorAposta(valor, qtdeApostas, qtdeNum, qtdeTrevo1, qtdeTrevo2) {
      const container = document.getElementById('valor-aposta-container');
      if (valor && qtdeApostas) {
        const valorFormatado = new Intl.NumberFormat('pt-BR', {
          style: 'currency',
          currency: 'BRL'
        }).format(valor);
        
        container.innerHTML = `
          <div class="bg-[#00E38C] text-black p-3 rounded-xl font-bold text-lg mb-2">
            ${valorFormatado}
          </div>
          <div class="text-sm text-gray-300 mb-1">
            <strong>${qtdeApostas}</strong> combina√ß√µes
          </div>
          <div class="text-xs text-gray-400">
            ${qtdeNum} n√∫meros + ${qtdeTrevo1} trevo1 + ${qtdeTrevo2} trevo2
          </div>
        `;
      } else {
        container.innerHTML = '<div class="text-gray-400 text-sm">Aposta n√£o configurada</div>';
      }
    }

    // Carregar estat√≠sticas r√°pidas
    function carregarEstatisticasRapidas() {
      document.getElementById('numeros-quentes').innerHTML = 
        dadosMilionaria.frequencia.numeros.quentes.slice(0, 5)
          .map(n => `<span class="bg-[#00E38C] text-black px-1 py-0.5 rounded text-xs mr-1">${n}</span>`)
          .join('');

      document.getElementById('numeros-frios').innerHTML = 
        dadosMilionaria.frequencia.numeros.frios.slice(0, 5)
          .map(n => `<span class="bg-gray-600 text-white px-1 py-0.5 rounded text-xs mr-1">${n}</span>`)
          .join('');

      document.getElementById('trevos-frequentes').innerHTML = 
        dadosMilionaria.frequencia.trevos.frequentes.slice(0, 3)
          .map(t => `<span class="bg-[#8B5CF6] text-white px-1 py-0.5 rounded text-xs mr-1">${t}</span>`)
          .join('');
    }

    // Abrir modal
    function abrirModal(tipo) {
      const modal = document.getElementById('modal');
      const titulo = document.getElementById('titulo-modal');
      const conteudo = document.getElementById('conteudo-modal');
      
      modal.classList.remove('hidden');
      
      switch(tipo) {
        case 'frequencia':
          titulo.textContent = 'üìä An√°lise de Frequ√™ncia';
          carregarAnaliseFrequencia(conteudo);
          break;
        case 'distribuicao':
          titulo.textContent = 'üî¢ An√°lise de Distribui√ß√£o';
          carregarAnaliseDistribuicao(conteudo);
          break;
        case 'afinidades':
          titulo.textContent = 'ü§ù An√°lise de Afinidades';
          carregarAnaliseAfinidades(conteudo);
          break;
        case 'trevos':
          titulo.textContent = 'üçÄ An√°lise dos Trevos';
          carregarAnaliseTrevos(conteudo);
          break;
        case 'seca':
          titulo.textContent = 'üåµ An√°lise de Seca';
          carregarAnaliseSeca(conteudo);
          break;
        case 'estatisticas':
          titulo.textContent = 'üìà Estat√≠sticas Avan√ßadas';
          carregarEstatisticasAvancadas(conteudo);
          break;
      }
    }

    // Fechar modal
    function fecharModal() {
      document.getElementById('modal').classList.add('hidden');
    }

    // Carregar an√°lise de frequ√™ncia
    async function carregarAnaliseFrequencia(container) {
      container.innerHTML = "üîÑ Carregando an√°lise de frequ√™ncia...";

      try {
        const response = await fetch('/api/analise-frequencia');
        const data = await response.json();

        if (data.error) {
          container.innerHTML = `<p style="color: red;">Erro: ${data.error}</p>`;
          return;
        }

        container.innerHTML = `
          <div class="space-y-6">
            <!-- Cabe√ßalho com t√≠tulo e ajuda -->
            <div class="flex justify-between items-start">
              <div class="bg-[#2E303A] p-4 rounded-xl flex-1">
                <h3 class="text-lg font-semibold mb-3 text-[#00E38C]">üéØ Janela de An√°lise Temporal</h3>
                <div class="flex flex-wrap gap-3 items-center">
                  <label class="text-sm text-gray-300">Per√≠odo:</label>
                  <select id="janela-analise" class="bg-[#1A1D25] text-white px-3 py-2 rounded-lg border border-gray-600 focus:border-[#00E38C] focus:outline-none" onchange="atualizarAnaliseFrequencia()">
                    <option value="">Todos os concursos</option>
                    <option value="25">√öltimos 25 concursos</option>
                    <option value="50">√öltimos 50 concursos</option>
                    <option value="100">√öltimos 100 concursos</option>
                    <option value="200">√öltimos 200 concursos</option>
                  </select>
                  <span class="text-xs text-gray-400">(Selecione para atualizar a an√°lise)</span>
                </div>
              </div>
              <button onclick="abrirPopupAjuda()" class="ml-4 bg-red-600 hover:bg-red-700 text-white p-2 rounded-lg transition-colors duration-200" title="Como usar estes gr√°ficos?">
                ‚ùì
              </button>
            </div>
            
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">üî• N√∫meros Mais Quentes (Top 10)</h3>
              <div class="grid grid-cols-5 gap-2">
                ${data.numeros_quentes.slice(0, 10).map(n => 
                  `<div class="bg-[#00E38C] text-black p-3 rounded text-center font-semibold">${n[0]}</div>`
                ).join('')}
              </div>
            </div>
            
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">‚ùÑÔ∏è N√∫meros Mais Frios (Top 10)</h3>
              <div class="grid grid-cols-5 gap-2">
                ${data.numeros_frios.slice(0, 10).map(n => 
                  `<div class="bg-gray-600 text-white p-3 rounded text-center font-semibold">${n[0]}</div>`
                ).join('')}
              </div>
            </div>
            
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">üìä Gr√°fico de Frequ√™ncia Absoluta</h3>
              <div id="grafico-frequencia" style="height: 400px;"></div>
            </div>
            
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">üìà Gr√°fico de Frequ√™ncia Relativa (%)</h3>
              <div id="grafico-frequencia-relativa" style="height: 400px;"></div>
            </div>
          </div>
        `;
        
        // Criar gr√°fico absoluto com Plotly
        const xNumeros = data.frequencia_absoluta_numeros.map(e => e.numero);
        const yFreq = data.frequencia_absoluta_numeros.map(e => e.frequencia);

        Plotly.newPlot('grafico-frequencia', [{
          x: xNumeros,
          y: yFreq,
          type: 'bar',
          marker: { color: 'deepskyblue' }
        }], {
          title: 'Frequ√™ncia Absoluta dos N√∫meros',
          paper_bgcolor: '#1a1a1a',
          plot_bgcolor: '#1a1a1a',
          font: { color: 'white' },
          autosize: true,
          responsive: true,
          margin: { l: 40, r: 20, t: 40, b: 40, pad: 5 },
          xaxis: { automargin: true },
          yaxis: { automargin: true }
        }, { displayModeBar: false });

        // Criar gr√°fico relativo com Plotly
        const xNumerosRel = data.frequencia_relativa_numeros.map(e => e.numero);
        const yFreqRel = data.frequencia_relativa_numeros.map(e => e.frequencia);
        const linhaEsperada = Array(50).fill(2); // Linha de refer√™ncia 2%

        Plotly.newPlot('grafico-frequencia-relativa', [
          {
            x: xNumerosRel,
            y: yFreqRel,
            type: 'bar',
            name: 'Frequ√™ncia Relativa',
            marker: { color: '#00E38C' }
          },
          {
            x: xNumerosRel,
            y: linhaEsperada,
            type: 'scatter',
            mode: 'lines',
            name: 'Esperado (2%)',
            line: { color: 'red', dash: 'dash' }
          }
        ], {
          title: 'Frequ√™ncia Relativa dos N√∫meros (%)',
          paper_bgcolor: '#1a1a1a',
          plot_bgcolor: '#1a1a1a',
          font: { color: 'white' },
          yaxis: { automargin: true }, // Remove t√≠tulo do eixo Y
          xaxis: { automargin: true }, // Remove t√≠tulo do eixo X
          showlegend: false, // Remove legenda
          autosize: true,
          responsive: true,
          margin: { l: 40, r: 20, t: 40, b: 40, pad: 5 }
        }, { 
          displayModeBar: false,
          scrollZoom: false
        });

      } catch (error) {
        container.innerHTML = `<p style="color: red;">Erro ao carregar dados: ${error.message}</p>`;
      }
    }

    // Fun√ß√£o para atualizar an√°lise quando mudar a janela
    async function atualizarAnaliseFrequencia() {
      const janela = document.getElementById('janela-analise').value;
      const container = document.getElementById('conteudo-modal');
      
      container.innerHTML = "üîÑ Atualizando an√°lise...";

      try {
        const url = janela ? `/api/analise-frequencia?qtd_concursos=${janela}` : '/api/analise-frequencia';
        const response = await fetch(url);
        const data = await response.json();

        if (data.error) {
          container.innerHTML = `<p style="color: red;">Erro: ${data.error}</p>`;
          return;
        }

        // Recriar o conte√∫do com os novos dados
        container.innerHTML = `
          <div class="space-y-6">
            <!-- Cabe√ßalho com t√≠tulo e ajuda -->
            <div class="flex justify-between items-start">
              <div class="bg-[#2E303A] p-4 rounded-xl flex-1">
                <h3 class="text-lg font-semibold mb-3 text-[#00E38C]">üéØ Janela de An√°lise</h3>
                <div class="flex flex-wrap gap-3 items-center">
                  <label class="text-sm text-gray-300">Per√≠odo:</label>
                  <select id="janela-analise" class="bg-[#1A1D25] text-white px-3 py-2 rounded-lg border border-gray-600 focus:border-[#00E38C] focus:outline-none" onchange="atualizarAnaliseFrequencia()">
                    <option value="" ${janela === '' ? 'selected' : ''}>Todos os concursos</option>
                    <option value="25" ${janela === '25' ? 'selected' : ''}>√öltimos 25 concursos</option>
                    <option value="50" ${janela === '50' ? 'selected' : ''}>√öltimos 50 concursos</option>
                    <option value="100" ${janela === '100' ? 'selected' : ''}>√öltimos 100 concursos</option>
                    <option value="200" ${janela === '200' ? 'selected' : ''}>√öltimos 200 concursos</option>
                  </select>
                  <span class="text-xs text-gray-400">(Selecione para atualizar a an√°lise)</span>
                </div>
              </div>
              <button onclick="abrirPopupAjuda()" class="ml-4 bg-red-600 hover:bg-red-700 text-white p-2 rounded-lg transition-colors duration-200" title="Como usar estes gr√°ficos?">
                ‚ùì
              </button>
            </div>
            
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">üî• N√∫meros Mais Quentes (Top 10)</h3>
              <div class="grid grid-cols-5 gap-2">
                ${data.numeros_quentes.slice(0, 10).map(n => 
                  `<div class="bg-[#00E38C] text-black p-3 rounded text-center font-semibold">${n[0]}</div>`
                ).join('')}
              </div>
            </div>
            
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">‚ùÑÔ∏è N√∫meros Mais Frios (Top 10)</h3>
              <div class="grid grid-cols-5 gap-2">
                ${data.numeros_frios.slice(0, 10).map(n => 
                  `<div class="bg-gray-600 text-white p-3 rounded text-center font-semibold">${n[0]}</div>`
                ).join('')}
              </div>
            </div>
            
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">üìä Gr√°fico de Frequ√™ncia Absoluta</h3>
              <div id="grafico-frequencia" style="height: 400px;"></div>
            </div>
            
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">üìà Gr√°fico de Frequ√™ncia Relativa (%)</h3>
              <div id="grafico-frequencia-relativa" style="height: 400px;"></div>
            </div>
          </div>
        `;
        
        // Recriar gr√°fico absoluto com novos dados
        const xNumeros = data.frequencia_absoluta_numeros.map(e => e.numero);
        const yFreq = data.frequencia_absoluta_numeros.map(e => e.frequencia);

        Plotly.newPlot('grafico-frequencia', [{
          x: xNumeros,
          y: yFreq,
          type: 'bar',
          marker: { color: 'deepskyblue' }
        }], {
          title: `Frequ√™ncia Absoluta dos N√∫meros ${janela ? `(√öltimos ${janela} concursos)` : '(Todos os concursos)'}`,
          paper_bgcolor: '#1a1a1a',
          plot_bgcolor: '#1a1a1a',
          font: { color: 'white' },
          autosize: true,
          responsive: true,
          margin: { l: 40, r: 20, t: 40, b: 40, pad: 5 },
          xaxis: { automargin: true },
          yaxis: { automargin: true }
        }, { displayModeBar: false });

        // Recriar gr√°fico relativo com novos dados
        const xNumerosRel = data.frequencia_relativa_numeros.map(e => e.numero);
        const yFreqRel = data.frequencia_relativa_numeros.map(e => e.frequencia);
        const linhaEsperada = Array(50).fill(2); // Linha de refer√™ncia 2%

        Plotly.newPlot('grafico-frequencia-relativa', [
          {
            x: xNumerosRel,
            y: yFreqRel,
            type: 'bar',
            name: 'Frequ√™ncia Relativa',
            marker: { color: '#00E38C' }
          },
          {
            x: xNumerosRel,
            y: linhaEsperada,
            type: 'scatter',
            mode: 'lines',
            name: 'Esperado (2%)',
            line: { color: 'red', dash: 'dash' }
          }
        ], {
          title: `Frequ√™ncia Relativa dos N√∫meros (%) ${janela ? `(√öltimos ${janela} concursos)` : '(Todos os concursos)'}`,
          paper_bgcolor: '#1a1a1a',
          plot_bgcolor: '#1a1a1a',
          font: { color: 'white' },
          yaxis: { automargin: true }, // Remove t√≠tulo do eixo Y
          xaxis: { automargin: true }, // Remove t√≠tulo do eixo X
          showlegend: false, // Remove legenda
          autosize: true,
          responsive: true,
          margin: { l: 40, r: 20, t: 40, b: 40, pad: 5 }
        }, { 
          displayModeBar: false,
          scrollZoom: false
        });

              } catch (error) {
          container.innerHTML = `<p style="color: red;">Erro ao atualizar dados: ${error.message}</p>`;
        }
      }

      // Fun√ß√µes para o popup de ajuda
      function abrirPopupAjuda() {
        document.getElementById("popupAjuda").style.display = "block";
      }

      function fecharPopupAjuda() {
        document.getElementById("popupAjuda").style.display = "none";
      }

    // Carregar an√°lise de distribui√ß√£o
    function carregarAnaliseDistribuicao(container) {
      container.innerHTML = `
        <div class="space-y-6">
          <div class="grid grid-cols-2 gap-4">
            <div class="stat-card p-4">
              <h4 class="font-semibold mb-2">üìä Distribui√ß√£o Par/√çmpar</h4>
              <p class="text-2xl font-bold text-[#00E38C]">${dadosMilionaria.distribuicao.pares.toFixed(2)} / ${dadosMilionaria.distribuicao.impares.toFixed(2)}</p>
              <p class="text-sm text-gray-400">Pares / √çmpares por concurso</p>
            </div>
            <div class="stat-card p-4">
              <h4 class="font-semibold mb-2">üéØ Distribui√ß√£o por Faixas</h4>
              <div class="space-y-1">
                ${Object.entries(dadosMilionaria.distribuicao.faixas).map(([faixa, media]) => 
                  `<div class="flex justify-between text-sm">
                    <span>${faixa}:</span>
                    <span class="text-[#00E38C]">${media.toFixed(1)}</span>
                  </div>`
                ).join('')}
              </div>
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="text-lg font-semibold mb-4">üìà Gr√°fico de Distribui√ß√£o</h3>
            <div id="grafico-distribuicao" style="height: 400px;"></div>
          </div>
        </div>
      `;
      
      criarGraficoDistribuicao();
    }

    // Carregar an√°lise de afinidades
    function carregarAnaliseAfinidades(container) {
      container.innerHTML = `
        <div class="space-y-6">
          <div class="grid grid-cols-2 gap-6">
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">ü§ù Afinidades Positivas</h3>
              <div class="space-y-2">
                ${dadosMilionaria.afinidades.positivas.map(afinidade => 
                  `<div class="flex justify-between items-center p-2 bg-[#2E303A] rounded">
                    <span class="font-semibold">${afinidade.num1} ‚Üî ${afinidade.num2}</span>
                    <span class="text-[#00E38C]">${afinidade.correlacao.toFixed(3)}</span>
                  </div>`
                ).join('')}
              </div>
            </div>
            
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">üö´ Afinidades Negativas</h3>
              <div class="space-y-2">
                ${dadosMilionaria.afinidades.negativas.map(afinidade => 
                  `<div class="flex justify-between items-center p-2 bg-[#2E303A] rounded">
                    <span class="font-semibold">${afinidade.num1} ‚Üî ${afinidade.num2}</span>
                    <span class="text-red-400">${afinidade.correlacao.toFixed(3)}</span>
                  </div>`
                ).join('')}
              </div>
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="text-lg font-semibold mb-4">üìä Matriz de Correla√ß√£o</h3>
            <div id="grafico-correlacao" style="height: 400px;"></div>
          </div>
        </div>
      `;
      
      criarGraficoCorrelacao();
    }

    // Carregar an√°lise de trevos
    function carregarAnaliseTrevos(container) {
      container.innerHTML = `
        <div class="space-y-6">
          <div class="chart-container">
            <h3 class="text-lg font-semibold mb-4">üçÄ Frequ√™ncia dos Trevos</h3>
            <div class="grid grid-cols-6 gap-4">
              ${dadosMilionaria.frequencia.trevos.frequentes.map((trevo, index) => 
                `<div class="bg-[#8B5CF6] text-white p-4 rounded text-center">
                  <div class="text-2xl font-bold">${trevo}</div>
                  <div class="text-sm">${index + 1}¬∫ mais frequente</div>
                </div>`
              ).join('')}
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="text-lg font-semibold mb-4">üìä Gr√°fico dos Trevos</h3>
            <div id="grafico-trevos" style="height: 400px;"></div>
          </div>
        </div>
      `;
      
      criarGraficoTrevos();
    }

    // Carregar an√°lise de seca
    function carregarAnaliseSeca(container) {
      container.innerHTML = `
        <div class="space-y-6">
          <div class="grid grid-cols-2 gap-6">
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">üåµ N√∫meros em Maior Seca</h3>
              <div class="space-y-2">
                ${dadosMilionaria.seca.maior.map((numero, index) => 
                  `<div class="flex justify-between items-center p-2 bg-[#2E303A] rounded">
                    <span class="font-semibold">${numero}</span>
                    <span class="text-red-400">${15 + index} concursos</span>
                  </div>`
                ).join('')}
              </div>
            </div>
            
            <div class="chart-container">
              <h3 class="text-lg font-semibold mb-4">üéØ N√∫meros Recentes</h3>
              <div class="space-y-2">
                ${dadosMilionaria.seca.recentes.map((numero, index) => 
                  `<div class="flex justify-between items-center p-2 bg-[#2E303A] rounded">
                    <span class="font-semibold">${numero}</span>
                    <span class="text-[#00E38C]">${index + 1} concurso(s)</span>
                  </div>`
                ).join('')}
              </div>
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="text-lg font-semibold mb-4">üìä Gr√°fico de Seca</h3>
            <div id="grafico-seca" style="height: 400px;"></div>
          </div>
        </div>
      `;
      
      criarGraficoSeca();
    }

    // Carregar estat√≠sticas avan√ßadas
    function carregarEstatisticasAvancadas(container) {
      container.innerHTML = `
        <div class="space-y-6">
          <div class="grid grid-cols-2 gap-6">
            <div class="stat-card p-4">
              <h4 class="font-semibold mb-2">üé≤ Teste de Aleatoriedade</h4>
              <p class="text-lg font-bold text-[#00E38C]">ALEAT√ìRIO</p>
              <p class="text-sm text-gray-400">P-valor: 0.9916</p>
            </div>
            <div class="stat-card p-4">
              <h4 class="font-semibold mb-2">üìä Desvio Padr√£o</h4>
              <p class="text-lg font-bold text-[#00E38C]">6.11</p>
              <p class="text-sm text-gray-400">Coeficiente: 18.94%</p>
            </div>
          </div>
          
          <div class="chart-container">
            <h3 class="text-lg font-semibold mb-4">üîó An√°lise de Clusters</h3>
            <div id="grafico-clusters" style="height: 400px;"></div>
          </div>
        </div>
      `;
      
      criarGraficoClusters();
    }

    // Fun√ß√µes para criar gr√°ficos (simuladas)
    function criarGraficoFrequencia() {
      // Implementar gr√°fico real com Plotly
      console.log('Criando gr√°fico de frequ√™ncia...');
    }

    function criarGraficoDistribuicao() {
      console.log('Criando gr√°fico de distribui√ß√£o...');
    }

    function criarGraficoCorrelacao() {
      console.log('Criando gr√°fico de correla√ß√£o...');
    }

    function criarGraficoTrevos() {
      console.log('Criando gr√°fico de trevos...');
    }

    function criarGraficoSeca() {
      console.log('Criando gr√°fico de seca...');
    }

    function criarGraficoClusters() {
      console.log('Criando gr√°fico de clusters...');
    }

    // Fun√ß√£o para gerar n√∫meros aleat√≥rios (GRATUITO)
    async function gerarNumerosAleatorios() {
      // Capturar o bot√£o no in√≠cio da fun√ß√£o
      const botao = event.target;
      const textoOriginal = botao.innerHTML;
      
      try {
        // Mostrar loading
        botao.innerHTML = 'üé≤ Gerando...';
        botao.disabled = true;
        
        // Chamar API para gerar n√∫meros aleat√≥rios
        const response = await fetch('/api/gerar-numeros-aleatorios');
        const dados = await response.json();
        
        if (dados.success) {
          // Limpar sele√ß√µes anteriores (sem mostrar mensagem)
          limparSelecaoSilenciosa();
          
          // Selecionar n√∫meros aleat√≥rios
          dados.numeros.forEach(numero => {
            const elementos = document.querySelectorAll('#numeros-container .numero');
            const elemento = Array.from(elementos).find(el => el.textContent.trim() === numero.toString().padStart(2, '0'));
            if (elemento) {
              selecionarNumero(numero, elemento);
            }
          });
          
          // Selecionar trevo 1
          const trevo1Elementos = document.querySelectorAll('#trevo1-container .trevo');
          const trevo1Elemento = Array.from(trevo1Elementos).find(el => el.textContent.trim() === dados.trevo1.toString());
          if (trevo1Elemento) {
            selecionarTrevo1(dados.trevo1, trevo1Elemento);
          }
          
          // Selecionar trevo 2
          const trevo2Elementos = document.querySelectorAll('#trevo2-container .trevo');
          const trevo2Elemento = Array.from(trevo2Elementos).find(el => el.textContent.trim() === dados.trevo2.toString());
          if (trevo2Elemento) {
            selecionarTrevo2(dados.trevo2, trevo2Elemento);
          }
          
          // Mostrar sucesso
          mostrarMensagem('‚úÖ N√∫meros gerados com sucesso!', 'success');
        } else {
          throw new Error(dados.error || 'Erro ao gerar n√∫meros');
        }
      } catch (error) {
        console.error('Erro:', error);
        mostrarMensagem('‚ùå Erro ao gerar n√∫meros. Tente novamente.', 'error');
      } finally {
        // Restaurar bot√£o usando a refer√™ncia capturada
        botao.innerHTML = 'üé≤ Gerar Aleat√≥rio <span class="bg-black text-[#00E38C] px-2 py-1 rounded text-sm">GRATUITO</span>';
        botao.disabled = false;
      }
    }

    // Fun√ß√£o para limpar todas as sele√ß√µes (silenciosa - sem mensagem)
    function limparSelecaoSilenciosa() {
      // Limpar n√∫meros selecionados
      numerosSelecionados = [];
      document.querySelectorAll('#numeros-container .numero').forEach(el => {
        el.classList.remove('selecionado');
      });
      
      // Limpar trevo 1
      trevo1Selecionados = [];
      document.querySelectorAll('#trevo1-container .trevo').forEach(el => {
        el.classList.remove('selecionado');
      });
      
      // Limpar trevo 2
      trevo2Selecionados = [];
      document.querySelectorAll('#trevo2-container .trevo').forEach(el => {
        el.classList.remove('selecionado');
      });
      
      // Atualizar displays
      atualizarNumerosSelecionados();
      atualizarTrevo1Selecionado();
      atualizarTrevo2Selecionado();
      atualizarValorAposta(null, null, null, null, null);
    }

    // Fun√ß√£o para limpar todas as sele√ß√µes (com mensagem)
    function limparSelecao() {
      limparSelecaoSilenciosa();
      mostrarMensagem('üóëÔ∏è Sele√ß√£o limpa com sucesso!', 'info');
    }

    // Fun√ß√£o para mostrar mensagens
    function mostrarMensagem(texto, tipo) {
      // Criar elemento de mensagem
      const mensagem = document.createElement('div');
      mensagem.className = `fixed top-4 right-4 p-4 rounded-xl text-white font-semibold z-50 transition-all duration-300 ${
        tipo === 'success' ? 'bg-green-600' :
        tipo === 'error' ? 'bg-red-600' :
        'bg-blue-600'
      }`;
      mensagem.textContent = texto;
      
      // Adicionar ao DOM
      document.body.appendChild(mensagem);
      
      // Remover ap√≥s 3 segundos
      setTimeout(() => {
        mensagem.remove();
      }, 3000);
    }

    // ===== MODAL DE CONFIGURA√á√ÉO DE APOSTA =====
    
    // Elementos do modal
    const modalConfiguracao = document.getElementById('modalConfiguracao');
    const btnCancelarModal = document.getElementById('btnCancelarModal');
    const btnGerarNoModal = document.getElementById('btnGerarNoModal');
    const sliderNumeros = document.getElementById('sliderNumeros');
    const valorNumeros = document.getElementById('valorNumeros');
    const sliderTrevo1 = document.getElementById('sliderTrevo1');
    const valorTrevo1 = document.getElementById('valorTrevo1');
    const sliderTrevo2 = document.getElementById('sliderTrevo2');
    const valorTrevo2 = document.getElementById('valorTrevo2');

    // Atualiza os valores exibidos pelos sliders
    sliderNumeros.oninput = () => {
      valorNumeros.textContent = sliderNumeros.value;
    };
    sliderTrevo1.oninput = () => {
      valorTrevo1.textContent = sliderTrevo1.value;
    };
    sliderTrevo2.oninput = () => {
      valorTrevo2.textContent = sliderTrevo2.value;
    };

    // Abrir o modal
    function abrirModalConfiguracao() {
      modalConfiguracao.classList.remove('hidden');
    }

    // Fechar o modal
    btnCancelarModal.addEventListener('click', () => {
      modalConfiguracao.classList.add('hidden');
    });

    // Gerar aposta ao clicar no bot√£o dentro do modal
    btnGerarNoModal.addEventListener('click', () => {
      const qtdeNum = parseInt(sliderNumeros.value);
      const qtdeTrevo1 = parseInt(sliderTrevo1.value);
      const qtdeTrevo2 = parseInt(sliderTrevo2.value);
      gerarApostaAleatoria(qtdeNum, qtdeTrevo1, qtdeTrevo2);
      modalConfiguracao.classList.add('hidden'); // Fecha o modal ap√≥s gerar
    });

    // Fun√ß√£o para chamar o backend Flask
    async function gerarApostaAleatoria(qtdeNum, qtdeTrevo1, qtdeTrevo2) {
      try {
        mostrarMensagem('üé≤ Gerando sua aposta...', 'info');
        
        const response = await fetch('/api/gerar-aposta-milionaria', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            qtde_num: qtdeNum,
            qtde_trevo1: qtdeTrevo1,
            qtde_trevo2: qtdeTrevo2
          })
        });

        if (!response.ok) {
          throw new Error(`Erro HTTP: ${response.status}`);
        }

        const data = await response.json();
        console.log("Aposta Gerada:", data);
        
        // Limpar sele√ß√µes anteriores
        limparSelecaoSilenciosa();
        
        // Selecionar n√∫meros aleat√≥rios automaticamente
        data.numeros.forEach(numero => {
          const elementos = document.querySelectorAll('#numeros-container .numero');
          const elemento = Array.from(elementos).find(el => el.textContent.trim() === numero.toString().padStart(2, '0'));
          if (elemento) {
            selecionarNumeroAutomatico(numero, elemento);
          }
        });
        
        // Selecionar m√∫ltiplos n√∫meros para Trevo 1
        if (Array.isArray(data.trevo1)) {
          data.trevo1.forEach(trevo => {
            const trevo1Elementos = document.querySelectorAll('#trevo1-container .trevo');
            const trevo1Elemento = Array.from(trevo1Elementos).find(el => el.textContent.trim() === trevo.toString());
            if (trevo1Elemento) {
              selecionarTrevo1(trevo, trevo1Elemento);
            }
          });
        } else {
          // Fallback para compatibilidade (trevo √∫nico)
          const trevo1Elementos = document.querySelectorAll('#trevo1-container .trevo');
          const trevo1Elemento = Array.from(trevo1Elementos).find(el => el.textContent.trim() === data.trevo1.toString());
          if (trevo1Elemento) {
            selecionarTrevo1(data.trevo1, trevo1Elemento);
          }
        }
        
        // Selecionar m√∫ltiplos n√∫meros para Trevo 2
        if (Array.isArray(data.trevo2)) {
          data.trevo2.forEach(trevo => {
            const trevo2Elementos = document.querySelectorAll('#trevo2-container .trevo');
            const trevo2Elemento = Array.from(trevo2Elementos).find(el => el.textContent.trim() === trevo.toString());
            if (trevo2Elemento) {
              selecionarTrevo2(trevo, trevo2Elemento);
            }
          });
        } else {
          // Fallback para compatibilidade (trevo √∫nico)
          const trevo2Elementos = document.querySelectorAll('#trevo2-container .trevo');
          const trevo2Elemento = Array.from(trevo2Elementos).find(el => el.textContent.trim() === data.trevo2.toString());
          if (trevo2Elemento) {
            selecionarTrevo2(data.trevo2, trevo2Elemento);
          }
        }
        
        // Atualizar valor da aposta
        atualizarValorAposta(data.valor, data.qtde_apostas, qtdeNum, qtdeTrevo1, qtdeTrevo2);
        
        mostrarMensagem(`‚úÖ Aposta gerada com sucesso! ${data.qtde_apostas} combina√ß√µes`, 'success');

      } catch (error) {
        console.error("Erro ao gerar aposta:", error);
        mostrarMensagem(`‚ùå Erro ao gerar aposta: ${error.message}`, 'error');
      }
    }
  </script>







  <!-- Popup de Ajuda -->
  <div id="popupAjuda" class="modal-ajuda">
    <div class="modal-content">
      <span class="close" onclick="fecharPopupAjuda()">√ó</span>
      <h2>üß† Entendendo os Gr√°ficos</h2>
      <p>Esses gr√°ficos mostram padr√µes que podem te ajudar a escolher seus n√∫meros com mais estrat√©gia.</p>

      <h3>üìä Frequ√™ncia Absoluta</h3>
      <p>
        Quantas vezes cada n√∫mero ou trevo foi sorteado.<br>
        <strong>‚úî √ötil para:</strong> ver os mais e menos sorteados at√© hoje.
      </p>

      <h3>üìà Frequ√™ncia Relativa</h3>
      <p>
        Mostra a frequ√™ncia em porcentagem, comparando com o esperado em sorteios aleat√≥rios.<br>
        <strong>‚úî √ötil para:</strong> saber se um n√∫mero saiu mais ou menos do que o "normal".
      </p>

      <h3>üî• N√∫meros Quentes</h3>
      <p>
        S√£o os que mais sa√≠ram recentemente. Alguns jogadores acreditam que est√£o em "alta".
      </p>

      <h3>‚ùÑÔ∏è N√∫meros Frios</h3>
      <p>
        S√£o os que h√° tempos n√£o aparecem. Alguns apostadores preferem dar chance a eles.
      </p>

      <h3>üïí An√°lise Temporal</h3>
      <p>
        Compara os n√∫meros mais frequentes em blocos (√∫ltimos 10%, 20%, 30% dos concursos).<br>
        <strong>‚úî √ötil para:</strong> detectar tend√™ncias mais recentes.
      </p>

      <p style="margin-top: 20px; font-style: italic;">
        Estes gr√°ficos <strong>n√£o garantem acertos</strong>, mas ajudam a apostar com mais consci√™ncia estat√≠stica.
      </p>
    </div>
  </div>

  <!-- CSS para o popup de ajuda e gr√°ficos responsivos -->
  <style>
  .modal-ajuda {
    display: none;
    position: fixed;
    z-index: 10000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.85);
  }

  /* Gr√°ficos responsivos */
  .chart-container {
    padding: 10px;
    margin: 10px 0;
  }

  @media (max-width: 768px) {
    .chart-container {
      padding: 5px;
      margin: 5px 0;
    }
    
    .chart-container h3 {
      font-size: 1rem;
      margin-bottom: 0.5rem;
    }
    
    .chart-container div[id^="grafico-"] {
      height: 350px !important; /* Aumenta ainda mais sem t√≠tulos de eixo */
      width: 100% !important;
    }
  }

  @media (max-width: 640px) {
    .chart-container div[id^="grafico-"] {
      height: 310px !important; /* Aumenta ainda mais sem t√≠tulos de eixo */
    }
    
    /* Otimiza√ß√µes espec√≠ficas para gr√°ficos Plotly em mobile */
    .js-plotly-plot .plotly .modebar {
      display: none !important;
    }
    
    /* Esconde legendas em mobile para economizar espa√ßo */
    .js-plotly-plot .plotly .legend {
      display: none !important;
    }
    
    .js-plotly-plot .plotly .legend .traces {
      display: none !important;
    }
  }

  /* Mostra legendas em desktop */
  @media (min-width: 769px) {
    .js-plotly-plot .plotly .legend {
      display: block !important;
      font-size: 11px !important;
    }
    
    .js-plotly-plot .plotly .legend .traces {
      display: block !important;
      font-size: 11px !important;
    }
  }

  .modal-ajuda .modal-content {
    background-color: #1c1c1c;
    color: #eee;
    margin: 10% auto;
    padding: 20px;
    border-radius: 12px;
    width: 90%;
    max-width: 600px;
    max-height: 90vh; /* Limita altura m√°xima */
    overflow-y: auto; /* Permite rolagem vertical */
    -webkit-overflow-scrolling: touch; /* Melhora rolagem em iOS */
    scroll-behavior: smooth; /* Scroll suave */
    font-family: 'Inter', sans-serif;
    box-shadow: 0 0 20px #000;
  }

  .modal-ajuda .close {
    color: #aaa;
    float: right;
    font-size: 26px;
    cursor: pointer;
  }

  .modal-ajuda .close:hover {
    color: red;
  }

  .modal-ajuda h2 {
    color: #00E38C;
    margin-bottom: 15px;
  }

  .modal-ajuda h3 {
    color: #00E38C;
    margin-top: 20px;
    margin-bottom: 10px;
  }

  .modal-ajuda p {
    line-height: 1.6;
    margin-bottom: 10px;
  }

  /* Otimiza√ß√µes mobile para modal de ajuda */
  @media (max-width: 768px) {
    .modal-ajuda .modal-content {
      margin: 5% auto; /* Reduz margem superior */
      width: 95%; /* Ocupa mais largura */
      padding: 15px; /* Reduz padding */
    }
  }

  @media (max-width: 640px) {
    .modal-ajuda .modal-content {
      margin: 3% auto; /* Margem ainda menor */
      width: 98%; /* Quase toda a largura */
      padding: 12px; /* Padding menor */
    }
  }
  </style>

  <script src="{{ url_for('static', filename='js/graficos.js') }}"></script>
</body>
</html> 