<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Meta tags para colorir a status bar dos dispositivos m√≥veis -->
  <meta name="theme-color" content="#7C3AED">
  <meta name="msapplication-navbutton-color" content="#7C3AED">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-capable" content="yes">
  
  <title>Lotomania | An√°lise Estat√≠stica</title>
  
  <!-- Favicons otimizados para todos os dispositivos -->
  <link rel="icon" href="/static/img/Favicon_LI.png" type="image/png" sizes="32x32">
  <link rel="icon" href="/static/img/Favicon_LI.png" type="image/png" sizes="16x16">
  <link rel="icon" href="/static/img/Favicon_LI.png" type="image/png" sizes="48x48">
  <link rel="icon" href="/static/img/Favicon_LI.png" type="image/png" sizes="192x192">
  <link rel="icon" href="/static/img/Favicon_LI.png" type="image/png" sizes="512x512">
  
  <!-- Apple Touch Icons para iOS -->
  <link rel="apple-touch-icon" href="/static/img/Favicon_LI.png" sizes="180x180">
  <link rel="apple-touch-icon" href="/static/img/Favicon_LI.png" sizes="152x152">
  <link rel="apple-touch-icon" href="/static/img/Favicon_LI.png" sizes="144x144">
  <link rel="apple-touch-icon" href="/static/img/Favicon_LI.png" sizes="120x120">
  <link rel="apple-touch-icon" href="/static/img/Favicon_LI.png" sizes="114x114">
  <link rel="apple-touch-icon" href="/static/img/Favicon_LI.png" sizes="76x76">
  <link rel="apple-touch-icon" href="/static/img/Favicon_LI.png" sizes="72x72">
  <link rel="apple-touch-icon" href="/static/img/Favicon_LI.png" sizes="60x60">
  <link rel="apple-touch-icon" href="/static/img/Favicon_LI.png" sizes="57x57">
  
  <!-- Android Chrome Icons -->
  <link rel="icon" type="image/png" sizes="192x192" href="/static/img/Favicon_LI.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/static/img/Favicon_LI.png">
  
  <!-- Windows Tiles -->
  <meta name="msapplication-TileColor" content="#7C3AED">
  <meta name="msapplication-TileImage" content="/static/img/Favicon_LI.png">
  <meta name="msapplication-config" content="none">
  
  <!-- Manifest para PWA -->
  <link rel="manifest" href="/static/manifest.json">

  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"></noscript>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <script src="https://cdn.tailwindcss.com"></script>

  <script>
    tailwind.config = {
      important: false,
      corePlugins: {
        preflight: false,
      },
      theme: {
        extend: {
          colors: {
            'primary': '#00E38C',
            'secondary': '#8B5CF6',
            'background': '#000000',
            'card': '#1A1D25',
            'surface': '#2E303A',
          }
        }
      }
    }
  </script>

  <link rel="stylesheet" href="{{ url_for('static', filename='css/estilo.css') }}">

  <style>
    /* Moldura Neon Lil√°s - Desktop */
    html::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      box-shadow: inset 0 0 0 4px #B96AFF, 0 0 15px #B96AFF, 0 0 30px #B96AFF;
      z-index: 9999;
      pointer-events: none;
    }

    /* Moldura Neon Lil√°s - Mobile (mais fina) */
    @media (max-width: 768px) {
      html::before {
        box-shadow: inset 0 0 0 2px #B96AFF, 0 0 8px #B96AFF, 0 0 15px #B96AFF;
      }
    }

    /* Auto-ajuste centralizado da imagem da Lotomania */
    .lotomania-logo-container {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      position: relative;
    }
    
    .lotomania-logo {
      max-width: 240px;
      min-width: 96px;
      height: auto;
      object-fit: contain;
      display: block;
      margin: 0 auto;
      margin-left: 15px !important;
      margin-bottom: -8px;
      transition: all 0.3s ease;
      vertical-align: bottom;
      transform: translateX(15px);
    }
    
    /* Responsividade total para mobile e tablet */
    @media (max-width: 640px) {
      .lotomania-logo {
        max-width: 144px;
        min-width: 72px;
        height: 58px;
      }
    }
    
    @media (min-width: 641px) and (max-width: 768px) {
      .lotomania-logo {
        max-width: 180px;
        min-width: 84px;
        height: 77px;
      }
    }
    
    @media (min-width: 769px) and (max-width: 1024px) {
      .lotomania-logo {
        max-width: 216px;
        min-width: 96px;
        height: 96px;
      }
    }
    
    @media (min-width: 1025px) {
      .lotomania-logo {
        max-width: 240px;
        min-width: 120px;
        height: 115px;
      }
    }

    /* Estilos para os menus responsivos */
    .desktop-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: linear-gradient(135deg, rgba(30, 27, 41, 0.95) 0%, rgba(42, 35, 64, 0.95) 100%);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      z-index: 1000;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .desktop-nav .logo {
      max-width: 150px;
      height: auto;
    }

    .desktop-nav-links {
      display: flex;
      gap: 2rem;
      align-items: center;
    }

    .desktop-nav-links a {
      color: #ffffff;
      text-decoration: none;
      font-size: 0.95rem;
      font-weight: 500;
      transition: all 0.3s ease;
      padding: 0.5rem 1rem;
      border-radius: 6px;
    }

    .desktop-nav-links a:hover {
      color: #A855F7;
      background: rgba(168, 85, 247, 0.1);
      transform: translateY(-1px);
    }

    .desktop-nav-links a.active {
      color: #00E38C !important;
      background: rgba(0, 227, 140, 0.15) !important;
      border: 1px solid rgba(0, 227, 140, 0.3) !important;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0, 227, 140, 0.2);
    }

    /* Ajuste do padding do body para o menu desktop */
    body {
      padding-top: 80px !important;
    }

    @media (max-width: 768px) {
      body {
        padding-top: 1rem !important;
      }
      .desktop-nav {
        display: none;
      }
    }

    @media (min-width: 769px) {
      .desktop-nav {
        display: flex;
      }
    }

    /* Estilos para Breadcrumbs */
    .breadcrumbs-container {
      background: linear-gradient(135deg, rgba(168, 85, 247, 0.05) 0%, rgba(0, 227, 140, 0.05) 100%);
      border-bottom: 1px solid rgba(168, 85, 247, 0.2);
      padding: 8px 0;
      margin-bottom: 20px;
    }
    
    .breadcrumbs {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    .breadcrumb-list {
      display: flex;
      align-items: center;
      list-style: none;
      margin: 0;
      padding: 0;
      font-size: 0.9rem;
    }
    
    .breadcrumb-item {
      display: flex;
      align-items: center;
      color: #94a3b8;
    }
    
    .breadcrumb-item:not(:last-child)::after {
      content: "‚Ä∫";
      margin: 0 8px;
      color: #64748b;
      font-weight: bold;
    }
    
    .breadcrumb-link {
      color: #cbd5e1;
      text-decoration: none;
      padding: 4px 8px;
      border-radius: 4px;
      transition: all 0.3s ease;
      font-weight: 500;
    }
    
    .breadcrumb-item:not(.active) .breadcrumb-link:hover {
      color: #A855F7;
      background: rgba(168, 85, 247, 0.1);
    }
    
    .breadcrumb-item.active .breadcrumb-link {
      color: #00E38C;
      font-weight: 600;
    }
  </style>
</head>
<body class="p-4 sm:p-6">
  <!-- Menu Desktop -->
  <nav class="desktop-nav">
    <img src="/static/img/Logo_LoteriasIntelitente.png" alt="Logo" class="logo">
    <div class="desktop-nav-links">
      <a href="/"><i class="fa fa-home"></i> In√≠cio</a>
      <div class="dropdown">
        <a href="#" class="dropdown-toggle"><i class="fa fa-diamond"></i> +Milion√°ria ‚ñº</a>
        <div class="dropdown-content">
          <a href="/dashboard"><i class="fa fa-bullseye"></i> Palpite da Sorte</a>
          <a href="/aposta_inteligente_premium"><i class="fa fa-chart-line"></i> Intelig√™ncia Estat√≠stica</a>
        </div>
      </div>
      <div class="dropdown">
        <a href="#" class="dropdown-toggle"><i class="fa fa-bullseye"></i> Mega Sena ‚ñº</a>
        <div class="dropdown-content">
          <a href="/dashboard_MS"><i class="fa fa-bullseye"></i> Palpite da Sorte</a>
          <a href="/aposta_inteligente_premium_MS"><i class="fa fa-chart-line"></i> Intelig√™ncia Estat√≠stica</a>
        </div>
      </div>
      <div class="dropdown">
        <a href="#" class="dropdown-toggle"><i class="fa fa-hashtag"></i> Quina ‚ñº</a>
        <div class="dropdown-content">
          <a href="/dashboard_quina"><i class="fa fa-bullseye"></i> Palpite da Sorte</a>
          <a href="/aposta_inteligente_premium_quina"><i class="fa fa-chart-line"></i> Intelig√™ncia Estat√≠stica</a>
        </div>
      </div>
      <div class="dropdown">
        <a href="#" class="dropdown-toggle active"><i class="fa fa-circle"></i> Lotomania ‚ñº</a>
        <div class="dropdown-content">
                     <a href="/dashboard_lotomania"><i class="fa fa-bullseye"></i> Palpite da Sorte</a>
           <a href="/estatisticas_lotomania"><i class="fa fa-chart-bar"></i> Estat√≠sticas</a>
           <a href="/analise_estatistica_avancada_lotomania" class="active"><i class="fa fa-chart-line"></i> An√°lise Estat√≠stica</a>
        </div>
      </div>
      <div class="dropdown">
        <a href="#" class="dropdown-toggle"><i class="fa fa-dice"></i> Lotof√°cil ‚ñº</a>
        <div class="dropdown-content">
          <a href="/dashboard_lotofacil"><i class="fa fa-bullseye"></i> Palpite da Sorte</a>
          <a href="/aposta_inteligente_premium_lotofacil"><i class="fa fa-chart-line"></i> Intelig√™ncia Estat√≠stica</a>
        </div>
      </div>
      <a href="/boloes"><i class="fa fa-users"></i> Bol√µes</a>
      <a href="#"><i class="fa fa-phone"></i> Contato</a>
    </div>
  </nav>

  <!-- Breadcrumbs -->
  <div class="breadcrumbs-container">
    <nav class="breadcrumbs" aria-label="Breadcrumb">
      <ol class="breadcrumb-list">
        <li class="breadcrumb-item">
          <a href="#" class="breadcrumb-link">‚≠ï Lotomania</a>
        </li>
        <li class="breadcrumb-item active">
          <span class="breadcrumb-link">üìä An√°lise Estat√≠stica</span>
        </li>
      </ol>
    </nav>
  </div>

  <!-- Header -->
  <header class="flex justify-between items-center mb-8">
    <div class="flex-1 text-center lotomania-logo-container">
      <h1 class="text-2xl sm:text-3xl font-bold text-white mb-2 flex justify-center items-center">
        <img src="/static/img/Lotomania.png" alt="Lotomania" class="lotomania-logo">
      </h1>
    </div>
    <div class="flex justify-end items-center">
      <img src="/static/img/Logo_LoteriasIntelitente.png" alt="Logo Loterias Inteligente" class="max-w-[120px] sm:max-w-[150px] md:max-w-[180px]">
    </div>
  </header>

  <!-- Informa√ß√£o dos sorteios -->
  <div class="text-center mb-4" style="margin-left: -15px;">
    <p class="text-orange-500 font-semibold text-lg mb-0">Sorteios: Segundas, Quartas e Sexta-feiras</p>
  </div>

  <!-- Container principal -->
  <div class="max-w-7xl mx-auto">
    <!-- Passos de An√°lise -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <!-- Passo 1 -->
      <div class="bg-[#1A1D25] p-6 rounded-2xl shadow-md">
        <div class="flex items-center mb-4">
          <div class="bg-[#00E38C] text-black w-8 h-8 rounded-full flex items-center justify-center font-bold mr-3">1</div>
          <h3 class="text-lg font-semibold">üìä An√°lise de Frequ√™ncia</h3>
        </div>
        <p class="text-gray-300 text-sm">An√°lise completa de frequ√™ncia dos n√∫meros mais e menos sorteados</p>
        <button onclick="carregarPasso1()" class="mt-4 bg-[#00E38C] text-black px-4 py-2 rounded-lg font-semibold hover:opacity-80 transition-all w-full">
          Carregar An√°lise
        </button>
      </div>

      <!-- Passo 2 -->
      <div class="bg-[#1A1D25] p-6 rounded-2xl shadow-md">
        <div class="flex items-center mb-4">
          <div class="bg-[#00E38C] text-black w-8 h-8 rounded-full flex items-center justify-center font-bold mr-3">2</div>
          <h3 class="text-lg font-semibold">üéØ An√°lise de Posi√ß√µes</h3>
        </div>
        <p class="text-gray-300 text-sm">An√°lise de quais n√∫meros saem mais em cada posi√ß√£o</p>
        <button onclick="carregarPasso2()" class="mt-4 bg-[#00E38C] text-black px-4 py-2 rounded-lg font-semibold hover:opacity-80 transition-all w-full">
          Carregar An√°lise
        </button>
      </div>

      <!-- Passo 3 -->
      <div class="bg-[#1A1D25] p-6 rounded-2xl shadow-md">
        <div class="flex items-center mb-4">
          <div class="bg-[#00E38C] text-black w-8 h-8 rounded-full flex items-center justify-center font-bold mr-3">3</div>
          <h3 class="text-lg font-semibold">üìà Padr√µes Temporais</h3>
        </div>
        <p class="text-gray-300 text-sm">An√°lise de tend√™ncias e padr√µes ao longo do tempo</p>
        <button onclick="carregarPasso3()" class="mt-4 bg-[#00E38C] text-black px-4 py-2 rounded-lg font-semibold hover:opacity-80 transition-all w-full">
          Carregar An√°lise
        </button>
      </div>
    </div>

    <!-- √Årea de Gr√°ficos -->
    <div id="areaGraficos" class="bg-[#1A1D25] p-6 rounded-2xl shadow-md mb-8">
      <div class="text-center text-gray-400">
        <i class="fas fa-chart-line text-4xl mb-4"></i>
        <p>Selecione um passo acima para carregar as an√°lises estat√≠sticas</p>
      </div>
    </div>

    <!-- Bot√£o Gerar Aposta Inteligente -->
    <div class="text-center mb-8">
      <button onclick="gerarApostaInteligente()" class="bg-gradient-to-r from-[#00E38C] to-[#00D4A6] text-black px-8 py-4 rounded-2xl font-bold text-lg hover:opacity-80 transition-all shadow-lg">
        üéØ Gerar Aposta Inteligente
      </button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script>
    // Vari√°veis globais
    let dadosAnalise = {};
    let passoAtual = 0;

    // Carregar passo 1 - An√°lise de Frequ√™ncia
    async function carregarPasso1() {
      try {
        const response = await fetch('/api/analise-frequencia-lotomania');
        const data = await response.json();
        
        if (data && data.numeros_quentes_frios) {
          dadosAnalise.passo1 = data;
          renderizarPasso1(data);
          passoAtual = 1;
        } else {
          throw new Error('Dados n√£o encontrados');
        }
      } catch (error) {
        console.error('Erro ao carregar passo 1:', error);
        document.getElementById('areaGraficos').innerHTML = '<div class="text-center text-red-400"><p>Erro ao carregar dados</p></div>';
      }
    }

    // Renderizar passo 1
    function renderizarPasso1(data) {
      const areaGraficos = document.getElementById('areaGraficos');
      
      // Preparar dados para o gr√°fico
      const numeros = Object.keys(data.frequencia_absoluta.numeros).map(Number);
      const frequencias = Object.values(data.frequencia_absoluta.numeros);
      
      // Criar gr√°fico de frequ√™ncia
      const trace = {
        x: numeros,
        y: frequencias,
        type: 'bar',
        marker: {
          color: '#00E38C',
          line: {
            color: '#00D4A6',
            width: 1
          }
        },
        name: 'Frequ√™ncia'
      };

      const layout = {
        title: 'Frequ√™ncia Absoluta dos N√∫meros da Lotomania',
        xaxis: {
          title: 'N√∫meros (1-100)',
          gridcolor: '#2E303A'
        },
        yaxis: {
          title: 'Frequ√™ncia',
          gridcolor: '#2E303A'
        },
        plot_bgcolor: '#1A1D25',
        paper_bgcolor: '#1A1D25',
        font: {
          color: '#FFFFFF'
        },
        margin: {
          l: 60,
          r: 30,
          t: 60,
          b: 60
        }
      };

      const config = {
        responsive: true,
        displayModeBar: false
      };

      areaGraficos.innerHTML = '<div id="graficoFrequencia"></div>';
      Plotly.newPlot('graficoFrequencia', [trace], layout, config);

      // Adicionar informa√ß√µes sobre n√∫meros quentes/frios/secos
      let htmlInfo = '<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">';
      
      // N√∫meros quentes
      if (data.numeros_quentes_frios.numeros_quentes) {
        htmlInfo += `
          <div class="bg-card p-4 rounded-lg border-l-4 border-red-500 shadow-lg">
            <h3 class="text-lg font-bold text-white mb-2">üî• N√∫meros Quentes</h3>
            <div class="flex flex-wrap gap-2">
              ${data.numeros_quentes_frios.numeros_quentes.slice(0, 10).map(([num, freq]) => 
                `<span class="bg-surface text-white px-2 py-1 rounded font-bold text-sm">${num}</span>`
              ).join('')}
            </div>
          </div>
        `;
      }

      // N√∫meros frios
      if (data.numeros_quentes_frios.numeros_frios) {
        htmlInfo += `
          <div class="bg-card p-4 rounded-lg border-l-4 border-blue-500 shadow-lg">
            <h3 class="text-lg font-bold text-white mb-2">‚ùÑÔ∏è N√∫meros Frios</h3>
            <div class="flex flex-wrap gap-2">
              ${data.numeros_quentes_frios.numeros_frios.slice(0, 10).map(([num, freq]) => 
                `<span class="bg-surface text-white px-2 py-1 rounded font-bold text-sm">${num}</span>`
              ).join('')}
            </div>
          </div>
        `;
      }

      // N√∫meros secos
      if (data.numeros_quentes_frios.numeros_secos) {
        htmlInfo += `
          <div class="bg-card p-4 rounded-lg border-l-4 border-yellow-500 shadow-lg">
            <h3 class="text-lg font-bold text-white mb-2">üèúÔ∏è N√∫meros Secos</h3>
            <div class="flex flex-wrap gap-2">
              ${data.numeros_quentes_frios.numeros_secos.slice(0, 10).map(([num, freq]) => 
                `<span class="bg-surface text-white px-2 py-1 rounded font-bold text-sm">${num}</span>`
              ).join('')}
            </div>
          </div>
        `;
      }

      htmlInfo += '</div>';
      areaGraficos.innerHTML += htmlInfo;
    }

    // Carregar passo 2 - An√°lise de Posi√ß√µes
    async function carregarPasso2() {
      // Implementar an√°lise de posi√ß√µes
      document.getElementById('areaGraficos').innerHTML = `
        <div class="text-center text-gray-400">
          <i class="fas fa-chart-bar text-4xl mb-4"></i>
          <p>An√°lise de Posi√ß√µes - Em desenvolvimento</p>
        </div>
      `;
      passoAtual = 2;
    }

    // Carregar passo 3 - Padr√µes Temporais
    async function carregarPasso3() {
      // Implementar an√°lise temporal
      document.getElementById('areaGraficos').innerHTML = `
        <div class="text-center text-gray-400">
          <i class="fas fa-clock text-4xl mb-4"></i>
          <p>Padr√µes Temporais - Em desenvolvimento</p>
        </div>
      `;
      passoAtual = 3;
    }

    // Gerar aposta inteligente
    function gerarApostaInteligente() {
      if (passoAtual === 0) {
        alert('Por favor, carregue pelo menos um passo de an√°lise antes de gerar a aposta inteligente.');
        return;
      }

      // L√≥gica para gerar aposta baseada nas an√°lises
      let numerosRecomendados = [];
      
      if (dadosAnalise.passo1 && dadosAnalise.passo1.numeros_quentes_frios) {
        // Usar n√∫meros quentes como base
        const numerosQuentes = dadosAnalise.passo1.numeros_quentes_frios.numeros_quentes || [];
        numerosRecomendados = numerosQuentes.slice(0, 30).map(([num, freq]) => num);
        
        // Adicionar alguns n√∫meros frios para diversificar
        const numerosFrios = dadosAnalise.passo1.numeros_quentes_frios.numeros_frios || [];
        const numerosFriosEscolhidos = numerosFrios.slice(0, 20).map(([num, freq]) => num);
        
        numerosRecomendados = [...numerosRecomendados, ...numerosFriosEscolhidos].slice(0, 50);
      }

      if (numerosRecomendados.length === 0) {
        // Fallback: gerar n√∫meros aleat√≥rios
        numerosRecomendados = Array.from({length: 100}, (_, i) => i + 1)
          .sort(() => Math.random() - 0.5)
          .slice(0, 50);
      }

      // Ordenar n√∫meros
      numerosRecomendados.sort((a, b) => a - b);

      // Exibir resultado
      alert(`üéØ Aposta Inteligente Gerada!\n\nN√∫meros recomendados (${numerosRecomendados.length} n√∫meros):\n${numerosRecomendados.join(', ')}\n\nValor: R$ 3,00`);
    }

    // Inicializa√ß√£o
    document.addEventListener('DOMContentLoaded', function() {
      console.log('P√°gina de An√°lise Estat√≠stica da Lotomania carregada');
    });
  </script>
</body>
</html>
